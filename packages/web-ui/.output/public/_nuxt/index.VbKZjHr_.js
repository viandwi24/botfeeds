import{m as Be,x as De,p as Ne,y as Ue,I as Ae}from"./tabs.igz6-hyk.js";import{q as Le,h as A,r as C,s as M,v as he,x as ue,y as H,F as X,j as ee,z as _e,A as ie,_ as te,B as $e,C as J,D as ke,E as Y,G as Ve,H as He,o as I,c as F,a,I as Re,J as je,K as W,n as E,L as le,d as we,t as N,k as D,i as ne,g as R,w as $,l as x,b,M as Ge,N as qe,m as ze,O as Je,P as me,Q as oe,T as ge,R as Ke}from"./entry.6dM_dXCU.js";import{i as de,o as p,E as ce,u as q,t as Qe,d as Z,A as We,N as Ye,e as Ze,w as Xe,f as et,h as tt,g as pe,j as z,s as ot,n as Se,k as ae,l as se,P as G,m as L,q as lt,r as be,v as j,x as V,T as re,y as nt,p as U,_ as Pe,a as xe,b as at,c as fe,z as st}from"./api.e8gGccRP.js";import{_ as rt}from"./SelectMenu.ummBI4C7.js";import{_ as ut}from"./Textarea.44oLfERW.js";const it={wrapper:"relative flex items-start",container:"flex items-center h-5",base:"h-4 w-4 dark:checked:bg-current dark:checked:border-transparent dark:indeterminate:bg-current dark:indeterminate:border-transparent disabled:opacity-50 disabled:cursor-not-allowed focus:ring-0 focus:ring-transparent focus:ring-offset-transparent",form:"form-checkbox",rounded:"rounded",color:"text-{color}-500 dark:text-{color}-400",background:"bg-white dark:bg-gray-900",border:"border border-gray-300 dark:border-gray-700",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",inner:"ms-3 flex flex-col",label:"text-sm font-medium text-gray-700 dark:text-gray-200",required:"text-sm text-red-500 dark:text-red-400",help:"text-sm text-gray-500 dark:text-gray-400",default:{color:"primary"}},dt={wrapper:"relative",container:"z-50 group",trigger:"inline-flex w-full",width:"",background:"bg-white dark:bg-gray-900",shadow:"shadow-lg",rounded:"rounded-md",ring:"ring-1 ring-gray-200 dark:ring-gray-800",base:"overflow-hidden focus:outline-none relative",transition:{enterActiveClass:"transition ease-out duration-200",enterFromClass:"opacity-0 translate-y-1",enterToClass:"opacity-100 translate-y-0",leaveActiveClass:"transition ease-in duration-150",leaveFromClass:"opacity-100 translate-y-0",leaveToClass:"opacity-0 translate-y-1"},overlay:{base:"fixed inset-0 transition-opacity z-50",background:"bg-gray-200/75 dark:bg-gray-800/75",transition:{enterActiveClass:"ease-out duration-200",enterFromClass:"opacity-0",enterToClass:"opacity-100",leaveActiveClass:"ease-in duration-150",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"}},popper:{strategy:"fixed"},arrow:Le};var ct=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ct||{});let Ie=Symbol("PopoverContext");function ve(e){let m=ie(Ie,null);if(m===null){let s=new Error(`<${e} /> is missing a parent <${Fe.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,ve),s}return m}let pt=Symbol("PopoverGroupContext");function Te(){return ie(pt,null)}let Ce=Symbol("PopoverPanelContext");function ft(){return ie(Ce,null)}let Fe=A({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:m,attrs:s,expose:w}){var o;let t=C(null);w({el:t,$el:t});let d=C(1),i=C(null),n=C(null),r=C(null),l=C(null),c=M(()=>de(t)),O=M(()=>{var v,_;if(!p(i)||!p(l))return!1;for(let Q of document.querySelectorAll("body > *"))if(Number(Q==null?void 0:Q.contains(p(i)))^Number(Q==null?void 0:Q.contains(p(l))))return!0;let S=ce(),B=S.indexOf(p(i)),K=(B+S.length-1)%S.length,Oe=(B+1)%S.length,Ee=S[K],Me=S[Oe];return!((v=p(l))!=null&&v.contains(Ee))&&!((_=p(l))!=null&&_.contains(Me))}),P={popoverState:d,buttonId:C(null),panelId:C(null),panel:l,button:i,isPortalled:O,beforePanelSentinel:n,afterPanelSentinel:r,togglePopover(){d.value=q(d.value,{0:1,1:0})},closePopover(){d.value!==1&&(d.value=1)},close(v){P.closePopover();let _=v?v instanceof HTMLElement?v:v.value instanceof HTMLElement?p(v):p(P.button):p(P.button);_==null||_.focus()}};he(Ie,P),Qe(M(()=>q(d.value,{0:Z.Open,1:Z.Closed})));let g={buttonId:P.buttonId,panelId:P.panelId,close(){P.closePopover()}},y=Te(),u=y==null?void 0:y.registerPopover,[h,k]=We(),f=Ye({mainTreeNodeRef:y==null?void 0:y.mainTreeNodeRef,portals:h,defaultContainers:[i,l]});function T(){var v,_,S,B;return(B=y==null?void 0:y.isFocusWithinPopoverGroup())!=null?B:((v=c.value)==null?void 0:v.activeElement)&&(((_=p(i))==null?void 0:_.contains(c.value.activeElement))||((S=p(l))==null?void 0:S.contains(c.value.activeElement)))}return ue(()=>u==null?void 0:u(g)),Ze((o=c.value)==null?void 0:o.defaultView,"focus",v=>{var _,S;v.target!==window&&v.target instanceof HTMLElement&&d.value===0&&(T()||i&&l&&(f.contains(v.target)||(_=p(P.beforePanelSentinel))!=null&&_.contains(v.target)||(S=p(P.afterPanelSentinel))!=null&&S.contains(v.target)||P.closePopover()))},!0),Xe(f.resolveContainers,(v,_)=>{var S;P.closePopover(),et(_,tt.Loose)||(v.preventDefault(),(S=p(i))==null||S.focus())},M(()=>d.value===0)),()=>{let v={open:d.value===0,close:P.close};return H(X,[H(k,{},()=>pe({theirProps:{...e,...s},ourProps:{ref:t},slot:v,slots:m,attrs:s,name:"Popover"})),H(f.MainTreeNode)])}}}),vt=A({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-popover-button-${z()}`}},inheritAttrs:!1,setup(e,{attrs:m,slots:s,expose:w}){let o=ve("PopoverButton"),t=M(()=>de(o.button));w({el:o.button,$el:o.button}),ee(()=>{o.buttonId.value=e.id}),_e(()=>{o.buttonId.value=null});let d=Te(),i=d==null?void 0:d.closeOthers,n=ft(),r=M(()=>n===null?!1:n.value===o.panelId.value),l=C(null),c=`headlessui-focus-sentinel-${z()}`;r.value||ue(()=>{o.button.value=p(l)});let O=ot(M(()=>({as:e.as,type:m.type})),l);function P(f){var T,v,_,S,B;if(r.value){if(o.popoverState.value===1)return;switch(f.key){case j.Space:case j.Enter:f.preventDefault(),(v=(T=f.target).click)==null||v.call(T),o.closePopover(),(_=p(o.button))==null||_.focus();break}}else switch(f.key){case j.Space:case j.Enter:f.preventDefault(),f.stopPropagation(),o.popoverState.value===1&&(i==null||i(o.buttonId.value)),o.togglePopover();break;case j.Escape:if(o.popoverState.value!==0)return i==null?void 0:i(o.buttonId.value);if(!p(o.button)||(S=t.value)!=null&&S.activeElement&&!((B=p(o.button))!=null&&B.contains(t.value.activeElement)))return;f.preventDefault(),f.stopPropagation(),o.closePopover();break}}function g(f){r.value||f.key===j.Space&&f.preventDefault()}function y(f){var T,v;e.disabled||(r.value?(o.closePopover(),(T=p(o.button))==null||T.focus()):(f.preventDefault(),f.stopPropagation(),o.popoverState.value===1&&(i==null||i(o.buttonId.value)),o.togglePopover(),(v=p(o.button))==null||v.focus()))}function u(f){f.preventDefault(),f.stopPropagation()}let h=Se();function k(){let f=p(o.panel);if(!f)return;function T(){q(h.value,{[V.Forwards]:()=>G(f,L.First),[V.Backwards]:()=>G(f,L.Last)})===re.Error&&G(ce().filter(v=>v.dataset.headlessuiFocusGuard!=="true"),q(h.value,{[V.Forwards]:L.Next,[V.Backwards]:L.Previous}),{relativeTo:p(o.button)})}T()}return()=>{let f=o.popoverState.value===0,T={open:f},{id:v,..._}=e,S=r.value?{ref:l,type:O.value,onKeydown:P,onClick:y}:{ref:l,id:v,type:O.value,"aria-expanded":o.popoverState.value===0,"aria-controls":p(o.panel)?o.panelId.value:void 0,disabled:e.disabled?!0:void 0,onKeydown:P,onKeyup:g,onClick:y,onMousedown:u};return H(X,[pe({ourProps:S,theirProps:{...m,..._},slot:T,attrs:m,slots:s,name:"PopoverButton"}),f&&!r.value&&o.isPortalled.value&&H(ae,{id:c,features:se.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k})])}}}),mt=A({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-popover-panel-${z()}`}},inheritAttrs:!1,setup(e,{attrs:m,slots:s,expose:w}){let{focus:o}=e,t=ve("PopoverPanel"),d=M(()=>de(t.panel)),i=`headlessui-focus-sentinel-before-${z()}`,n=`headlessui-focus-sentinel-after-${z()}`;w({el:t.panel,$el:t.panel}),ee(()=>{t.panelId.value=e.id}),_e(()=>{t.panelId.value=null}),he(Ce,t.panelId),ue(()=>{var u,h;if(!o||t.popoverState.value!==0||!t.panel)return;let k=(u=d.value)==null?void 0:u.activeElement;(h=p(t.panel))!=null&&h.contains(k)||G(p(t.panel),L.First)});let r=lt(),l=M(()=>r!==null?(r.value&Z.Open)===Z.Open:t.popoverState.value===0);function c(u){var h,k;switch(u.key){case j.Escape:if(t.popoverState.value!==0||!p(t.panel)||d.value&&!((h=p(t.panel))!=null&&h.contains(d.value.activeElement)))return;u.preventDefault(),u.stopPropagation(),t.closePopover(),(k=p(t.button))==null||k.focus();break}}function O(u){var h,k,f,T,v;let _=u.relatedTarget;_&&p(t.panel)&&((h=p(t.panel))!=null&&h.contains(_)||(t.closePopover(),((f=(k=p(t.beforePanelSentinel))==null?void 0:k.contains)!=null&&f.call(k,_)||(v=(T=p(t.afterPanelSentinel))==null?void 0:T.contains)!=null&&v.call(T,_))&&_.focus({preventScroll:!0})))}let P=Se();function g(){let u=p(t.panel);if(!u)return;function h(){q(P.value,{[V.Forwards]:()=>{var k;G(u,L.First)===re.Error&&((k=p(t.afterPanelSentinel))==null||k.focus())},[V.Backwards]:()=>{var k;(k=p(t.button))==null||k.focus({preventScroll:!0})}})}h()}function y(){let u=p(t.panel);if(!u)return;function h(){q(P.value,{[V.Forwards]:()=>{let k=p(t.button),f=p(t.panel);if(!k)return;let T=ce(),v=T.indexOf(k),_=T.slice(0,v+1),S=[...T.slice(v+1),..._];for(let B of S.slice())if(B.dataset.headlessuiFocusGuard==="true"||f!=null&&f.contains(B)){let K=S.indexOf(B);K!==-1&&S.splice(K,1)}G(S,L.First,{sorted:!1})},[V.Backwards]:()=>{var k;G(u,L.Previous)===re.Error&&((k=p(t.button))==null||k.focus())}})}h()}return()=>{let u={open:t.popoverState.value===0,close:t.close},{id:h,focus:k,...f}=e,T={ref:t.panel,id:h,onKeydown:c,onFocusout:o&&t.popoverState.value===0?O:void 0,tabIndex:-1};return pe({ourProps:T,theirProps:{...m,...f},attrs:m,slot:u,slots:{...s,default:(...v)=>{var _;return[H(X,[l.value&&t.isPortalled.value&&H(ae,{id:i,ref:t.beforePanelSentinel,features:se.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:g}),(_=s.default)==null?void 0:_.call(s,...v),l.value&&t.isPortalled.value&&H(ae,{id:n,ref:t.afterPanelSentinel,features:se.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:y})])]}},features:be.RenderStrategy|be.Static,visible:l.value,name:"PopoverPanel"})}}});const ye=$e(J.ui.strategy,J.ui.checkbox,it),gt=A({inheritAttrs:!1,props:{id:{type:String,default:()=>null},value:{type:[String,Number,Boolean,Object],default:null},modelValue:{type:[Boolean,Array],default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},help:{type:String,default:null},label:{type:String,default:null},required:{type:Boolean,default:!1},color:{type:String,default:()=>ye.default.color,validator(e){return J.ui.colors.includes(e)}},inputClass:{type:String,default:""},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:m}){const{ui:s,attrs:w}=ke("checkbox",Y(e,"ui"),ye,Y(e,"class")),{emitFormChange:o,color:t,name:d,inputId:i}=nt(e),n=M({get(){return e.modelValue},set(c){m("update:modelValue",c)}}),r=c=>{m("change",c),o()},l=M(()=>Ve(He(s.value.base,s.value.form,s.value.rounded,s.value.background,s.value.border,t.value&&s.value.ring.replaceAll("{color}",t.value),t.value&&s.value.color.replaceAll("{color}",t.value)),e.inputClass));return{ui:s,attrs:w,toggle:n,inputId:i,name:d,inputClass:l,onChange:r}}}),bt=["id","name","required","value","disabled","checked","indeterminate"],yt=["for"];function ht(e,m,s,w,o,t){return I(),F("div",{class:E(e.ui.wrapper)},[a("div",{class:E(e.ui.container)},[Re(a("input",W({id:e.inputId,"onUpdate:modelValue":m[0]||(m[0]=d=>e.toggle=d),name:e.name,required:e.required,value:e.value,disabled:e.disabled,checked:e.checked,indeterminate:e.indeterminate,type:"checkbox",class:e.inputClass},e.attrs,{onChange:m[1]||(m[1]=(...d)=>e.onChange&&e.onChange(...d))}),null,16,bt),[[je,e.toggle]])],2),e.label||e.$slots.label?(I(),F("div",{key:0,class:E(e.ui.inner)},[a("label",{for:e.inputId,class:E(e.ui.label)},[le(e.$slots,"label",{},()=>[we(N(e.label),1)]),e.required?(I(),F("span",{key:0,class:E(e.ui.required)},"*",2)):D("",!0)],10,yt),e.help?(I(),F("p",{key:0,class:E(e.ui.help)},N(e.help),3)):D("",!0)],2)):D("",!0)],2)}const _t=te(gt,[["render",ht]]),$t={class:"flex flex-col gap-4"},kt={class:"flex flex-col gap-2"},wt=a("label",null,"Name",-1),St={class:"flex flex-col gap-2"},Pt=a("label",null,"RSS URL",-1),xt={class:"flex flex-col gap-2"},It=a("label",null,"Triggers when item getted",-1),Tt={key:0,class:"flex flex-col gap-1"},Ct={class:"text-sm px-2 py-1 w-full rounded bg-primary-500"},Ft=a("div",{class:"w-full h-0.5 border-b border-gray-500"},null,-1),Ot=a("div",null,"Options",-1),Et={class:"flex gap-2"},Mt=a("label",{class:"w-1/4"},"Max Items to Get",-1),Bt={class:"flex items-center"},Dt={class:"text-xs italic ml-1 text-yellow-600"},Nt={class:"flex flex-col gap-2"},Ut=A({__name:"Source",props:{mode:{type:String,required:!0},data:{type:Object,required:!0}},emits:["close"],setup(e,{emit:m}){const s=e,w=m,o=ne(),t=C(s.data),d=C([]),i=async()=>{const l=await $fetch(U("/triggers"));d.value=l.data||[]};ee(()=>{i()});const n=C([...t.value.Triggers.map(l=>l.id)]),r=async()=>{try{if(s.mode==="edit"){const l=await $fetch(U(`/feeds/${s.data.id}`),{method:"PUT",body:JSON.stringify({name:t.value.name,url:t.value.url,config:{...t.value.config},triggers:n.value})});o.add({title:"Success",description:`Source ${t.value.name} saved`,color:"green"})}else{const l=await $fetch(U("/feeds/"),{method:"POST",body:JSON.stringify({name:t.value.name,url:t.value.url,config:{...t.value.config},triggers:n.value})});o.add({title:"Success",description:`Source ${t.value.name} created`,color:"green"})}w("close")}catch(l){console.error(l),o.add({title:"Error",description:`Error: ${l}`,color:"red"})}};return(l,c)=>{const O=Pe,P=rt,g=_t,y=xe;return I(),R(y,{open:!0,title:s.mode==="edit"?"Edit Source":"New Source",modalSize:"2xl",onClose:c[5]||(c[5]=()=>l.$emit("close"))},{"footer-actions":$(()=>[a("button",{class:"px-4 py-2 bg-blue-400 text-sm rounded",onClick:r},"Save")]),default:$(()=>[a("div",$t,[a("div",kt,[wt,b(O,{modelValue:x(t).name,"onUpdate:modelValue":c[0]||(c[0]=u=>x(t).name=u)},null,8,["modelValue"])]),a("div",St,[Pt,b(O,{modelValue:x(t).url,"onUpdate:modelValue":c[1]||(c[1]=u=>x(t).url=u)},null,8,["modelValue"])]),a("div",xt,[It,b(P,{modelValue:x(n),"onUpdate:modelValue":c[2]||(c[2]=u=>Ge(n)?n.value=u:null),options:x(d),placeholder:"Select triggers","value-attribute":"id","option-attribute":"name",multiple:""},null,8,["modelValue","options"]),x(n).length>0?(I(),F("div",Tt,[(I(!0),F(X,null,qe(x(d).filter(u=>x(n).find(h=>u.id===h)),(u,h)=>(I(),F("div",{class:"w-full",key:h},[a("span",Ct,N(u.name),1)]))),128))])):D("",!0)]),Ft,Ot,a("div",Et,[Mt,a("div",Bt,[b(O,{type:"number",modelValue:x(t).config.maxItemGet,"onUpdate:modelValue":c[3]||(c[3]=u=>x(t).config.maxItemGet=u),min:"1"},null,8,["modelValue"]),a("div",Dt,"* only get "+N(x(t).config.maxItemGet)+" newest item from RSS",1)])]),a("div",Nt,[b(g,{modelValue:x(t).config.forceSameItem,"onUpdate:modelValue":c[4]||(c[4]=u=>x(t).config.forceSameItem=u),label:"Force Same Item (if item already exist force to trigger again)"},null,8,["modelValue"])])])]),_:1},8,["title"])}}}),At=["innerHTML"],Lt=A({__name:"index",setup(e){const m=ne(),s=C(null),w=C("edit"),o=C(),t=async n=>{const r=ne(),l=Math.random();r.add({id:`feed-run-${n.id}${l}`,title:`Running feed ${n.name}`,description:"Please wait...",color:"gray",timeout:0}),await new Promise(c=>setTimeout(c,1e3));try{const c=await fetch(U(`/feeds/${n.id}/run`),{method:"POST"});console.log(await c.json()),r.remove(`feed-run-${n.id}${l}`),r.add({id:`feed-runned-${n.id}-${Math.random()}`,title:`Feed ${n.name} runned`,color:"green",icon:"i-heroicons-check-circle"})}catch{r.remove(`feed-run-${n.id}${l}`),r.add({id:`feed-runned-${n.id}-${Math.random()}`,title:`Feed ${n.name} failed to run`,color:"red",icon:"i-heroicons-x-circle"})}},d=async n=>{const r=window.confirm("Are you sure?");try{if(!r)return;const l=await $fetch(U(`/feeds/${n}/reset`),{method:"POST"});console.log(l),m.add({title:"Success",description:`Feed ${n} resetted`,color:"green"})}catch(l){console.error(l)}},i=async n=>{var l;const r=window.confirm("Are you sure?");try{if(!r)return;const c=await $fetch(U(`/feeds/${n}`),{method:"DELETE"});console.log(c),m.add({title:"Success",description:`Feed ${n} deleted`,color:"green"})}catch(c){console.error(c)}(l=s.value)==null||l.refresh()};return(n,r)=>{const l=ze,c=at,O=fe,P=Ut;return I(),F("div",null,[b(O,{ref_key:"datatable",ref:s,title:"Sources",columns:[{key:"name",data:"name",label:"Name"},{key:"rss",data:"url",label:"rss"},{key:"triggers",label:"Triggers"},{key:"action",label:""}],rows:[],"api-url":("parseApiURL"in n?n.parseApiURL:x(U))("/feeds")},{action:$(()=>[a("button",{class:"px-4 py-2 bg-gray-800 text-sm rounded",onClick:r[0]||(r[0]=()=>{w.value="create",o.value={id:-1,config:{forceSameItem:!1,maxItemGet:10},name:"your source name",url:"",Triggers:[]}})}," New ")]),"col-triggers":$(({data:g})=>[a("div",{innerHTML:[...(g==null?void 0:g.Triggers)||[]].map(y=>y==null?void 0:y.name).join("<br>")},null,8,At)]),"col-action":$(({data:g})=>[b(c,{items:[[{label:"Edit",icon:"i-heroicons-pencil-square-20-solid",click:()=>{w.value="edit",o.value=g}},{label:"Run (Test)",icon:"i-heroicons-play-20-solid",click:()=>t(g)}],[{label:"Reset Feed Items",icon:"i-heroicons-archive-box-arrow-down-16-solid",click:()=>d(g.id)}],[{label:"Delete",icon:"i-heroicons-trash-20-solid",click:()=>i(g.id)}]]},{default:$(()=>[b(l,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),_:1},8,["api-url"]),x(o)?(I(),R(P,{key:0,data:x(o),mode:x(w),onClose:r[1]||(r[1]=()=>{var g;o.value=void 0,(g=x(s))==null||g.refresh()})},null,8,["data","mode"])):D("",!0)])}}}),Vt=$e(J.ui.strategy,J.ui.popover,dt),Ht=A({components:{HPopover:Fe,HPopoverButton:vt,HPopoverPanel:mt},inheritAttrs:!1,props:{mode:{type:String,default:"click",validator:e=>["click","hover"].includes(e)},open:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},overlay:{type:Boolean,default:!1},popper:{type:Object,default:()=>({})},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:open"],setup(e,{emit:m}){const{ui:s,attrs:w}=ke("popover",Y(e,"ui"),Vt,Y(e,"class")),o=M(()=>Je(e.mode==="hover"?{offsetDistance:0}:{},e.popper,s.value.popper)),[t,d]=st(o.value),i=C(null),n=C(null);let r=null,l=null;ee(()=>{var u,h;const g=(u=i.value)==null?void 0:u.$.provides;if(!g)return;const y=Object.getOwnPropertySymbols(g);n.value=y.length&&g[y[0]],e.open&&((h=n.value)==null||h.togglePopover())});const c=M(()=>{var h,k,f;if(e.mode!=="hover")return{};const g=((h=e.popper)==null?void 0:h.offsetDistance)||((k=s.value.popper)==null?void 0:k.offsetDistance)||8,y=(f=o.value.placement)==null?void 0:f.split("-")[0],u=`${g}px`;return y==="top"||y==="bottom"?{paddingTop:u,paddingBottom:u}:y==="left"||y==="right"?{paddingLeft:u,paddingRight:u}:{paddingTop:u,paddingBottom:u,paddingLeft:u,paddingRight:u}});function O(){e.mode!=="hover"||!n.value||(l&&(clearTimeout(l),l=null),n.value.popoverState!==0&&(r=r||setTimeout(()=>{n.value.togglePopover&&n.value.togglePopover(),r=null},e.openDelay)))}function P(){e.mode!=="hover"||!n.value||(r&&(clearTimeout(r),r=null),n.value.popoverState!==1&&(l=l||setTimeout(()=>{n.value.closePopover&&n.value.closePopover(),l=null},e.closeDelay)))}return me(()=>e.open,(g,y)=>{n.value&&(y===void 0||g===y||(g?n.value.popoverState=0:n.value.closePopover()))}),me(()=>{var g;return(g=n.value)==null?void 0:g.popoverState},(g,y)=>{y===void 0||g===y||m("update:open",g===0)}),{ui:s,attrs:w,popover:i,popper:o,trigger:t,container:d,containerStyle:c,onMouseOver:O,onMouseLeave:P}}}),Rt=["disabled"];function jt(e,m,s,w,o,t){const d=oe("HPopoverButton"),i=oe("HPopoverPanel"),n=oe("HPopover");return I(),R(n,W({ref:"popover",class:e.ui.wrapper},e.attrs,{onMouseleave:e.onMouseLeave}),{default:$(({open:r,close:l})=>[b(d,{ref:"trigger",as:"div",disabled:e.disabled,class:E(e.ui.trigger),role:"button",onMouseover:e.onMouseOver},{default:$(()=>[le(e.$slots,"default",{open:r,close:l},()=>[a("button",{disabled:e.disabled}," Open ",8,Rt)])]),_:2},1032,["disabled","class","onMouseover"]),e.overlay?(I(),R(ge,W({key:0,appear:""},e.ui.overlay.transition),{default:$(()=>[r?(I(),F("div",{key:0,class:E([e.ui.overlay.base,e.ui.overlay.background])},null,2)):D("",!0)]),_:2},1040)):D("",!0),r?(I(),F("div",{key:1,ref:"container",class:E([e.ui.container,e.ui.width]),style:Ke(e.containerStyle),onMouseover:m[0]||(m[0]=(...c)=>e.onMouseOver&&e.onMouseOver(...c))},[b(ge,W({appear:""},e.ui.transition),{default:$(()=>[a("div",null,[e.popper.arrow?(I(),F("div",{key:0,"data-popper-arrow":"",class:E(Object.values(e.ui.arrow))},null,2)):D("",!0),b(i,{class:E([e.ui.base,e.ui.background,e.ui.ring,e.ui.rounded,e.ui.shadow]),static:""},{default:$(()=>[le(e.$slots,"panel",{open:r,close:l})]),_:2},1032,["class"])])]),_:2},1040)],38)):D("",!0)]),_:3},16,["class","onMouseleave"])}const Gt=te(Ht,[["render",jt]]),qt={},zt={class:"flex items-center gap-2"},Jt={key:0,class:"h-2 w-2 inline-block rounded-full bg-green-500"},Kt={key:1,class:"h-2 w-2 inline-block rounded-full bg-yellow-500"},Qt={key:2,class:"h-2 w-2 inline-block rounded-full bg-red-500"},Wt={class:"p-2 border border-gray-500 rounded-lg"};function Yt(e,m){const s=Gt,w=fe;return I(),R(w,{title:"Histories",columns:[{key:"feed-name",data:"Feed.name",label:"Name"},{key:"date",data:"date",label:"Date",type:"date"},{key:"rssUrl",data:"rssUrl",label:"rssUrl"},{key:"itemsCount",data:"itemsCount",label:"Total Item"},{key:"items",label:"Processed Items"},{key:"action",label:""}],rows:[],"api-url":("parseApiURL"in e?e.parseApiURL:x(U))("/feeds/histories")},{"col-feed-name":$(({data:o})=>[b(s,{mode:"hover"},{panel:$(()=>[a("div",Wt,N(o==null?void 0:o.status),1)]),default:$(()=>{var t;return[a("div",zt,[(o==null?void 0:o.status)=="success"?(I(),F("div",Jt)):(o==null?void 0:o.status)=="pending"?(I(),F("div",Kt)):(o==null?void 0:o.status)=="failed"?(I(),F("div",Qt)):D("",!0),we(" "+N((t=o==null?void 0:o.Feed)==null?void 0:t.name),1)])]}),_:2},1024)]),"col-items":$(({data:o})=>{var t,d;return[a("div",null,N(o==null?void 0:o.itemsProcessed)+"/"+N((d=(t=o==null?void 0:o.Feed)==null?void 0:t.config)==null?void 0:d.maxItemGet),1)]}),"col-action":$(({data:o})=>[]),_:1},8,["columns","api-url"])}const Zt=te(qt,[["render",Yt]]),Xt={class:"flex flex-col gap-4"},eo=a("label",{class:"block"},"Title",-1),to=a("label",{class:"block"},"URL",-1),oo=a("label",{class:"block"},"Byline",-1),lo={class:"flex gap-4"},no={class:"flex-1"},ao=a("label",{class:"block"},"Byline",-1),so={class:"flex-1"},ro=a("label",{class:"block"},"Dir",-1),uo=a("label",{class:"block"},"Content Length",-1),io=a("label",{class:"block"},"Site Name",-1),co=a("label",{class:"block"},"Excerpt",-1),po=a("label",{class:"block"},"Text Content",-1),fo=a("label",{class:"block"},"RSS Item",-1),vo=A({__name:"ViewFeedItem",props:{feedItem:{type:Object,required:!0}},emits:["close"],setup(e,{emit:m}){const s=m;return(w,o)=>{const t=Pe,d=ut,i=xe;return I(),R(i,{open:!0,title:"View Feed Item Data",modalSize:"2xl",onClose:o[0]||(o[0]=()=>{s("close")})},{default:$(()=>[a("div",Xt,[a("div",null,[eo,b(t,{type:"text",class:"w-full",value:e.feedItem.title||"-",readonly:""},null,8,["value"])]),a("div",null,[to,b(t,{type:"text",class:"w-full",value:e.feedItem.url||"-",readonly:""},null,8,["value"])]),a("div",null,[oo,b(t,{type:"text",class:"w-full",value:e.feedItem.byline||"-",readonly:""},null,8,["value"])]),a("div",lo,[a("div",no,[ao,b(t,{type:"text",class:"w-full",value:e.feedItem.lang||"-",readonly:""},null,8,["value"])]),a("div",so,[ro,b(t,{type:"text",class:"w-full",value:e.feedItem.dir||"-",readonly:""},null,8,["value"])])]),a("div",null,[uo,b(t,{type:"text",class:"w-full",value:e.feedItem.contentLength||"-",readonly:""},null,8,["value"])]),a("div",null,[io,b(t,{type:"text",class:"w-full",value:e.feedItem.siteName||"-",readonly:""},null,8,["value"])]),a("div",null,[co,b(t,{type:"text",class:"w-full",value:e.feedItem.excerpt||"-",readonly:""},null,8,["value"])]),a("div",null,[po,b(d,{type:"text",class:"w-full",value:e.feedItem.textContent||"-",readonly:"",rows:25},null,8,["value"])]),a("div",null,[fo,b(d,{type:"text",class:"w-full",value:JSON.stringify(e.feedItem.rssItem||"{}",null,2),readonly:"",rows:25},null,8,["value"])])])]),_:1})}}}),mo=["onClick"],go=A({__name:"Table",setup(e){const m=C(null),s=C();return(w,o)=>{const t=vo,d=fe;return I(),R(d,{ref_key:"datatable",ref:m,title:"Data",columns:[{key:"FeedHistory.name",data:"FeedHistory.Feed.name",label:"Name"},{key:"title",data:"title",label:"Title"},{key:"title",data:"rssItem.pubDate",label:"Pub Date"},{key:"url",data:"url",label:"URL"},{key:"action",label:""}],rows:[],"api-url":("parseApiURL"in w?w.parseApiURL:x(U))("/feeds/items")},{"col-items":$(({data:i})=>{var n,r;return[a("div",null,N(i==null?void 0:i.itemsProcessed)+"/"+N((r=(n=i==null?void 0:i.Feed)==null?void 0:n.config)==null?void 0:r.maxItemGet),1)]}),"col-action":$(({data:i})=>[a("button",{class:"text-sm text-gray-200",onClick:()=>{s.value=i}}," View ",8,mo)]),default:$(()=>[x(s)?(I(),R(t,{key:0,feedItem:x(s),onClose:o[0]||(o[0]=()=>{var i;s.value=void 0,(i=x(m))==null||i.refresh()})},null,8,["feedItem"])):D("",!0)]),_:1},8,["columns","api-url"])}}}),bo={};function yo(e,m){const s=De,w=Ne,o=Lt,t=Ue,d=Zt,i=go,n=Ae,r=Be;return I(),F("div",null,[b(r,null,{default:$(()=>[b(w,{class:"flex rounded overflow-hidden w-auto"},{default:$(()=>[b(s,{as:"template"},{default:$(({selected:l})=>[a("button",{class:E({"px-4 py-2 bg-gray-800":l,"px-4 py-2 bg-transparent":!l,"outline-none":!0})}," Feed Sources ",2)]),_:1}),b(s,{as:"template"},{default:$(({selected:l})=>[a("button",{class:E({"px-4 py-2 bg-gray-800":l,"px-4 py-2 bg-transparent":!l,"outline-none":!0})}," Feeds History ",2)]),_:1}),b(s,{as:"template"},{default:$(({selected:l})=>[a("button",{class:E({"px-4 py-2 bg-gray-800":l,"px-4 py-2 bg-transparent":!l,"outline-none":!0})}," Feeds Data ",2)]),_:1})]),_:1}),b(n,null,{default:$(()=>[b(t,{class:"mt-6"},{default:$(()=>[b(o)]),_:1}),b(t,{class:"mt-6"},{default:$(()=>[b(d)]),_:1}),b(t,{class:"mt-6"},{default:$(()=>[b(i)]),_:1})]),_:1})]),_:1})])}const So=te(bo,[["render",yo]]);export{So as default};
