import{h as V,i as w,r as x,j as E,o as m,g as S,w as _,c as f,k as h,a as s,l as t,n as $,t as T,d as U,b as i,F as k,m as C}from"./entry.6dM_dXCU.js";import{p as y,_ as N,a as z,b as D,c as M}from"./api.e8gGccRP.js";const I={class:"flex flex-col gap-4"},O={key:0,class:"flex flex-col gap-2"},R=s("label",null,"Current Status",-1),q={class:"flex items-center gap-2"},H={class:"flex flex-col gap-2"},K=s("label",null,"Name",-1),L=s("div",{class:"w-full h-0.5 border-b border-gray-500"},null,-1),P={class:"flex flex-col gap-2"},W=s("label",null,"Api Hash",-1),j={class:"flex flex-col gap-2"},F=s("label",null,"Api Id",-1),J={class:"flex flex-col gap-2"},G=s("label",null,"Bot Api Token",-1),Q={class:"flex flex-col gap-2"},X=s("label",null,"Session",-1),Y=s("div",{class:"text-red-500 text-xs"},"*nb: ignore this, this only session string saved from telegram to authorize our bot",-1),Z={class:"flex flex-col gap-2"},ee=s("label",null,"Access Token",-1),te={class:"flex flex-col gap-2"},oe=s("label",null,"Access Secret",-1),se={class:"flex flex-col gap-2"},le=s("label",null,"App Key",-1),ae={class:"flex flex-col gap-2"},ne=s("label",null,"App Secret",-1),ie={key:0},re={key:1},ce=V({__name:"Bot",props:{mode:{type:String,required:!0},data:{type:Object,required:!0}},emits:["close"],setup(r,{emit:p}){const d=r,b=p,g=w(),e=x(d.data),v=async()=>{try{if(d.mode==="edit"){const u=await $fetch(y(`/bots/${d.data.id}`),{method:"PUT",body:JSON.stringify({name:e.value.name,config:e.value.config})});g.add({title:"Success",description:`Source ${e.value.name} saved`,color:"green"})}else{const u=await $fetch(y("/bots/"),{method:"POST",body:JSON.stringify({name:e.value.name,service:e.value.service,config:e.value.config})});g.add({title:"Success",description:`Source ${e.value.name} created`,color:"green"})}b("close")}catch(u){console.error(u),g.add({title:"Error",description:`Error: ${u}`,color:"red"})}};return E(()=>console.log(d.data)),(u,o)=>{const a=N,c=z;return m(),S(c,{open:!0,title:d.mode==="edit"?"Edit Bot":"New Bot",modalSize:"2xl",onClose:o[9]||(o[9]=()=>u.$emit("close"))},{"footer-actions":_(()=>[s("button",{class:"px-4 py-2 bg-blue-400 text-sm rounded",onClick:v},[r.mode==="create"?(m(),f("span",ie,"Save")):h("",!0),r.mode==="edit"?(m(),f("span",re,"Save & Restart")):h("",!0)])]),default:_(()=>[s("div",I,[r.mode==="edit"?(m(),f("div",O,[R,s("div",q,[s("span",{class:$({"h-2 w-2 rounded-full":!0,"bg-green-500":t(e).status==="connected","bg-red-500":t(e).status==="disconnected","bg-yellow-500":t(e).status==="started","bg-gray-500":t(e).status==="stopped"})},null,2),U(" "+T(t(e).status),1)])])):h("",!0),s("div",H,[K,i(a,{modelValue:t(e).name,"onUpdate:modelValue":o[0]||(o[0]=l=>t(e).name=l)},null,8,["modelValue"])]),L,t(e).config.telegram?(m(),f(k,{key:1},[s("div",P,[W,i(a,{modelValue:t(e).config.telegram.apiHash,"onUpdate:modelValue":o[1]||(o[1]=l=>t(e).config.telegram.apiHash=l)},null,8,["modelValue"])]),s("div",j,[F,i(a,{type:"number",modelValue:t(e).config.telegram.apiId,"onUpdate:modelValue":o[2]||(o[2]=l=>t(e).config.telegram.apiId=l)},null,8,["modelValue"])]),s("div",J,[G,i(a,{modelValue:t(e).config.telegram.botApiToken,"onUpdate:modelValue":o[3]||(o[3]=l=>t(e).config.telegram.botApiToken=l)},null,8,["modelValue"])]),s("div",Q,[X,i(a,{modelValue:t(e).config.telegram.session,"onUpdate:modelValue":o[4]||(o[4]=l=>t(e).config.telegram.session=l)},null,8,["modelValue"]),Y])],64)):t(e).config.twitter?(m(),f(k,{key:2},[s("div",Z,[ee,i(a,{modelValue:t(e).config.twitter.accessToken,"onUpdate:modelValue":o[5]||(o[5]=l=>t(e).config.twitter.accessToken=l)},null,8,["modelValue"])]),s("div",te,[oe,i(a,{modelValue:t(e).config.twitter.accessTokenSecret,"onUpdate:modelValue":o[6]||(o[6]=l=>t(e).config.twitter.accessTokenSecret=l)},null,8,["modelValue"])]),s("div",se,[le,i(a,{modelValue:t(e).config.twitter.apiKey,"onUpdate:modelValue":o[7]||(o[7]=l=>t(e).config.twitter.apiKey=l)},null,8,["modelValue"])]),s("div",ae,[ne,i(a,{modelValue:t(e).config.twitter.apiSecret,"onUpdate:modelValue":o[8]||(o[8]=l=>t(e).config.twitter.apiSecret=l)},null,8,["modelValue"])])],64)):h("",!0)])]),_:1},8,["title"])}}}),de=r=>r.replace(/\b[a-z]/g,p=>p.toUpperCase()),ue={class:"flex items-center gap-2"},ge=V({__name:"Table",props:{service:{type:String,required:!0}},setup(r){const p=r,d=w(),b=x(null),g=x("edit"),e=x(),v=async(o,a="restart")=>{try{const c=await $fetch(y(`/bots/${o}/action/${a}`),{method:"POST"});d.add({title:"Success",description:`Bot ${o} ${a} success`,color:"green"})}catch(c){console.error(c),d.add({title:"Error",description:`Error: ${c}`,color:"red"})}},u=async o=>{var c;const a=window.confirm("Are you sure?");try{if(!a)return;const l=await $fetch(y(`/bots/${o}`),{method:"DELETE"});console.log(l)}catch(l){console.error(l)}(c=b.value)==null||c.refresh()};return(o,a)=>{const c=C,l=D,A=M,B=ce;return m(),f("div",null,[i(A,{ref_key:"datatable",ref:b,title:`${("capitalizeEachWord"in o?o.capitalizeEachWord:t(de))(r.service)} Bot`,columns:[{key:"name",data:"name",label:"Name"},{key:"status",label:"status"},{key:"action",label:""}],rows:[],"api-url":("parseApiURL"in o?o.parseApiURL:t(y))(`/bots/${r.service}`)},{action:_(()=>[s("button",{class:"px-4 py-2 bg-gray-800 text-sm rounded",onClick:a[0]||(a[0]=()=>{let n={};p.service==="telegram"?n={telegram:{apiHash:"",apiId:0,botApiToken:"",session:""}}:p.service==="twitter"&&(n={twitter:{apiKey:"",apiSecret:"",accessToken:"",accessTokenSecret:""}}),g.value="create",e.value={id:-1,name:"",service:p.service,config:n}})}," New ")]),"col-status":_(({data:n})=>[s("div",ue,[s("span",{class:$({"h-2 w-2 rounded-full":!0,"bg-green-500":n.status==="connected","bg-red-500":n.status==="disconnected","bg-yellow-500":n.status==="started","bg-gray-500":n.status==="stopped"})},null,2),U(" "+T(n.status),1)])]),"col-action":_(({data:n})=>[i(l,{items:[[{label:"Edit",icon:"i-heroicons-pencil-square-20-solid",click:()=>{g.value="edit",e.value=n}}],[{label:"Delete",icon:"i-heroicons-trash-20-solid",click:()=>u(n.id)}],[{label:"Start",icon:"i-heroicons-play-20-solid",click:()=>v(n.id,"start")},{label:"Stop",icon:"i-heroicons-stop-20-solid",click:()=>v(n.id,"stop")},{label:"Restart",icon:"i-heroicons-arrow-path-20-solid",click:()=>v(n.id,"restart")}]]},{default:_(()=>[i(c,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),_:1},8,["title","api-url"]),t(e)?(m(),S(B,{key:0,data:t(e),mode:t(g),onClose:a[1]||(a[1]=()=>{var n;e.value=void 0,(n=t(b))==null||n.refresh()})},null,8,["data","mode"])):h("",!0)])}}});export{ge as _};
