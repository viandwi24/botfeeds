import{m as Se,x as ke,p as xe,y as Ae,I as we}from"./tabs.igz6-hyk.js";import{h as Q,i as ve,o as s,g as L,w as $,b as f,m as oe,_ as ae,B as Oe,S as je,C as H,U as be,D as Pe,E as le,V as Ee,s as k,G as ze,H as M,c as h,a as y,F as W,N as Y,t as Z,K as Ve,n as F,L as se,k as A,W as J,X as K,Y as Le,r as w,P as Ne,j as Be,l as a,d as ue,Z as X,$ as Ue,a0 as ie,a1 as re,a2 as Re}from"./entry.6dM_dXCU.js";import{b as _e,y as Fe,p as N,_ as We,a as Ge,c as ye}from"./api.e8gGccRP.js";const Me=Q({__name:"RuntimeContextInputsViewer",props:{runtimeContext:{type:Object,required:!0}},setup(e){const o=ve(),r=t=>{if(navigator.clipboard)navigator.clipboard.writeText(t);else{const u=document.createElement("input");u.value=t,document.body.appendChild(u),u.select(),document.execCommand("copy"),document.body.removeChild(u)}o.add({title:"Copied",description:`Copied ${t}`,color:"green"})};return(t,u)=>{const l=oe,d=_e;return s(),L(d,{items:[e.runtimeContext.inputs.map(n=>({label:`{{${n[0]}}}`,click:()=>r(`{{${n[0]}}}`)}))]},{default:$(()=>[f(l,{color:"white",label:"Variables","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:1},8,["items"])}}}),O=Oe(H.ui.strategy,H.ui.select,je),De=Q({components:{UIcon:be},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>O.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>O.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},size:{type:String,default:null,validator(e){return Object.keys(O.size).includes(e)}},color:{type:String,default:()=>O.default.color,validator(e){return[...H.ui.colors,...Object.keys(O.color)].includes(e)}},variant:{type:String,default:()=>O.default.variant,validator(e){return[...Object.keys(O.variant),...Object.values(O.color).flatMap(o=>Object.keys(o))].includes(e)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:"value"},selectClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:o,slots:r}){const{ui:t,attrs:u}=Pe("select",le(e,"ui"),O,le(e,"class")),{size:l,rounded:d}=Ee({ui:t,props:e}),{emitFormChange:n,inputId:b,color:c,size:C,name:_}=Fe(e,O),I=k(()=>l.value||C.value),P=i=>{o("update:modelValue",i.target.value)},B=i=>{n(),o("change",i)},G=i=>J(i,e.valueAttribute,J(i,e.optionAttribute)),z=i=>J(i,e.optionAttribute,J(i,e.valueAttribute)),p=i=>["string","number","boolean"].includes(typeof i)?{[e.valueAttribute]:i,[e.optionAttribute]:i}:{...i,[e.valueAttribute]:G(i),[e.optionAttribute]:z(i)},V=k(()=>e.options.map(i=>p(i))),v=k(()=>e.placeholder?[{[e.valueAttribute]:"",[e.optionAttribute]:e.placeholder,disabled:!0},...V.value]:V.value),m=k(()=>{const i=p(e.modelValue),T=v.value.find(E=>E[e.valueAttribute]===i[e.valueAttribute]);return T?T[e.valueAttribute]:""}),x=k(()=>{var T,E;const i=((E=(T=t.value.color)==null?void 0:T[c.value])==null?void 0:E[e.variant])||t.value.variant[e.variant];return ze(M(t.value.base,t.value.form,d.value,t.value.size[I.value],e.padded?t.value.padding[I.value]:"p-0",i==null?void 0:i.replaceAll("{color}",c.value),(g.value||r.leading)&&t.value.leading.padding[I.value],(S.value||r.trailing)&&t.value.trailing.padding[I.value]),e.selectClass)}),g=k(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),S=k(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),j=k(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),U=k(()=>e.loading&&!g.value?e.loadingIcon:e.trailingIcon||e.icon),ee=k(()=>M(t.value.icon.leading.wrapper,t.value.icon.leading.pointer,t.value.icon.leading.padding[I.value])),R=k(()=>M(t.value.icon.base,c.value&&H.ui.colors.includes(c.value)&&t.value.icon.color.replaceAll("{color}",c.value),t.value.icon.size[I.value],e.loading&&t.value.icon.loading)),te=k(()=>M(t.value.icon.trailing.wrapper,t.value.icon.trailing.pointer,t.value.icon.trailing.padding[I.value])),q=k(()=>M(t.value.icon.base,c.value&&H.ui.colors.includes(c.value)&&t.value.icon.color.replaceAll("{color}",c.value),t.value.icon.size[I.value],e.loading&&!g.value&&t.value.icon.loading));return{ui:t,attrs:u,name:_,inputId:b,normalizedOptionsWithPlaceholder:v,normalizedValue:m,isLeading:g,isTrailing:S,selectClass:x,leadingIconName:j,leadingIconClass:R,leadingWrapperIconClass:ee,trailingIconName:U,trailingIconClass:q,trailingWrapperIconClass:te,onInput:P,onChange:B}}}),He=["id","name","value","required","disabled"],qe=["value","label"],Je=["value","selected","disabled","textContent"],Ke=["value","selected","disabled","textContent"];function Xe(e,o,r,t,u,l){const d=be;return s(),h("div",{class:F(e.ui.wrapper)},[y("select",Ve({id:e.inputId,name:e.name,value:e.modelValue,required:e.required,disabled:e.disabled,class:e.selectClass},e.attrs,{onInput:o[0]||(o[0]=(...n)=>e.onInput&&e.onInput(...n)),onChange:o[1]||(o[1]=(...n)=>e.onChange&&e.onChange(...n))}),[(s(!0),h(W,null,Y(e.normalizedOptionsWithPlaceholder,(n,b)=>(s(),h(W,null,[n.children?(s(),h("optgroup",{key:`${n[e.valueAttribute]}-optgroup-${b}`,value:n[e.valueAttribute],label:n[e.optionAttribute]},[(s(!0),h(W,null,Y(n.children,(c,C)=>(s(),h("option",{key:`${c[e.valueAttribute]}-${b}-${C}`,value:c[e.valueAttribute],selected:c[e.valueAttribute]===e.normalizedValue,disabled:c.disabled,textContent:Z(c[e.optionAttribute])},null,8,Je))),128))],8,qe)):(s(),h("option",{key:`${n[e.valueAttribute]}-${b}`,value:n[e.valueAttribute],selected:n[e.valueAttribute]===e.normalizedValue,disabled:n.disabled,textContent:Z(n[e.optionAttribute])},null,8,Ke))],64))),256))],16,He),e.isLeading&&e.leadingIconName||e.$slots.leading?(s(),h("span",{key:0,class:F(e.leadingWrapperIconClass)},[se(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[f(d,{name:e.leadingIconName,class:F(e.leadingIconClass)},null,8,["name","class"])])],2)):A("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(s(),h("span",{key:1,class:F(e.trailingWrapperIconClass)},[se(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[f(d,{name:e.trailingIconName,class:F(e.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])])],2)):A("",!0)],2)}const Ye=ae(De,[["render",Xe]]);function Ze(e){var o=typeof e;return e!=null&&(o=="object"||o=="function")}var he=Ze,Qe=typeof K=="object"&&K&&K.Object===Object&&K,et=Qe,tt=et,nt=typeof self=="object"&&self&&self.Object===Object&&self,ot=tt||nt||Function("return this")(),Ce=ot,at=Ce,it=function(){return at.Date.now()},rt=it,lt=/\s/;function st(e){for(var o=e.length;o--&&lt.test(e.charAt(o)););return o}var ut=st,ct=ut,dt=/^\s+/;function mt(e){return e&&e.slice(0,ct(e)+1).replace(dt,"")}var gt=mt,ft=Ce,pt=ft.Symbol,Te=pt,ce=Te,$e=Object.prototype,vt=$e.hasOwnProperty,bt=$e.toString,D=ce?ce.toStringTag:void 0;function _t(e){var o=vt.call(e,D),r=e[D];try{e[D]=void 0;var t=!0}catch{}var u=bt.call(e);return t&&(o?e[D]=r:delete e[D]),u}var yt=_t,ht=Object.prototype,Ct=ht.toString;function Tt(e){return Ct.call(e)}var $t=Tt,de=Te,It=yt,St=$t,kt="[object Null]",xt="[object Undefined]",me=de?de.toStringTag:void 0;function At(e){return e==null?e===void 0?xt:kt:me&&me in Object(e)?It(e):St(e)}var wt=At;function Ot(e){return e!=null&&typeof e=="object"}var jt=Ot,Pt=wt,Et=jt,zt="[object Symbol]";function Vt(e){return typeof e=="symbol"||Et(e)&&Pt(e)==zt}var Lt=Vt,Nt=gt,ge=he,Bt=Lt,fe=NaN,Ut=/^[-+]0x[0-9a-f]+$/i,Rt=/^0b[01]+$/i,Ft=/^0o[0-7]+$/i,Wt=parseInt;function Gt(e){if(typeof e=="number")return e;if(Bt(e))return fe;if(ge(e)){var o=typeof e.valueOf=="function"?e.valueOf():e;e=ge(o)?o+"":o}if(typeof e!="string")return e===0?e:+e;e=Nt(e);var r=Rt.test(e);return r||Ft.test(e)?Wt(e.slice(2),r?2:8):Ut.test(e)?fe:+e}var Mt=Gt,Dt=he,ne=rt,pe=Mt,Ht="Expected a function",qt=Math.max,Jt=Math.min;function Kt(e,o,r){var t,u,l,d,n,b,c=0,C=!1,_=!1,I=!0;if(typeof e!="function")throw new TypeError(Ht);o=pe(o)||0,Dt(r)&&(C=!!r.leading,_="maxWait"in r,l=_?qt(pe(r.maxWait)||0,o):l,I="trailing"in r?!!r.trailing:I);function P(g){var S=t,j=u;return t=u=void 0,c=g,d=e.apply(j,S),d}function B(g){return c=g,n=setTimeout(p,o),C?P(g):d}function G(g){var S=g-b,j=g-c,U=o-S;return _?Jt(U,l-j):U}function z(g){var S=g-b,j=g-c;return b===void 0||S>=o||S<0||_&&j>=l}function p(){var g=ne();if(z(g))return V(g);n=setTimeout(p,G(g))}function V(g){return n=void 0,I&&t?P(g):(t=u=void 0,d)}function v(){n!==void 0&&clearTimeout(n),c=0,t=b=u=n=void 0}function m(){return n===void 0?d:V(ne())}function x(){var g=ne(),S=z(g);if(t=arguments,u=this,b=g,S){if(n===void 0)return B(b);if(_)return clearTimeout(n),n=setTimeout(p,o),P(b)}return n===void 0&&(n=setTimeout(p,o)),d}return x.cancel=v,x.flush=m,x}var Xt=Kt;const Yt=Le(Xt),Zt=ie(()=>re(()=>import("./ChatGptCommanderPipe.KRv-A-Xa.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url).then(e=>e.default||e)),Qt=ie(()=>re(()=>import("./FilterSimplePipe._Xw85zSG.js"),__vite__mapDeps([6,7,2,3,4,5]),import.meta.url).then(e=>e.default||e)),en=ie(()=>re(()=>import("./OutputPipe.Kc1hPyeE.js"),__vite__mapDeps([8,7,2,3,4,1]),import.meta.url).then(e=>e.default||e)),tn={key:0,class:"flex flex-col gap-4"},nn={class:"flex flex-col gap-2"},on=y("label",null,"Name",-1),an=y("div",{class:"h-0.5 w-full bg-gray-500 rounded"},null,-1),rn={class:"flex flex-col gap-2"},ln={class:"font-semibold"},sn={key:0},un={key:0,class:"flex flex-col gap-4"},cn={class:"flex flex-col gap-2 items-center justify-center mb-3"},dn={class:"py-4 rounded border border-gray-500"},mn={class:"font-semibold pb-4 w-full text-center border-b border-gray-500"},gn={class:"px-4 pt-4"},fn={class:"px-4 mt-4 pt-4 flex justify-between items-center border-t border-gray-500 text-sm"},pn={key:0},vn={class:"flex gap-2"},bn={key:0,class:"flex items-center justify-center mt-3"},_n={key:0,class:"flex flex-col"},yn={class:"flex flex-col gap-2"},hn=y("label",null,"Pipe",-1),Cn=Q({__name:"Trigger",props:{data:{type:Object,required:!0},mode:{type:String,required:!0}},emits:["close"],setup(e,{emit:o}){const r=e,t=o,u=ve(),l=w(r.data),d=w([]),n=w(!1),b=async()=>{const v=await $fetch(N("/bots"));d.value=v.data||[],console.log("getted data bot",d.value)},c=async()=>{try{if(r.mode==="edit"){const v=await $fetch(N(`/triggers/${r.data.id}`),{method:"PUT",body:JSON.stringify({name:l.value.name,config:{...l.value.config}})});console.log(v)}else{const v=await $fetch(N("/triggers"),{method:"POST",body:JSON.stringify({name:l.value.name,config:{...l.value.config}})});console.log(v)}u.add({title:"Success",description:`Source ${l.value.name} saved`,color:"green"})}catch(v){console.error(v),u.add({title:"Error",description:`Error: ${v}`,color:"red"})}t("close")},C=w({...l.value.config}),_=w(),I=w(!1),P=async()=>{var v;try{I.value=!0;const m=await $fetch(N("/triggers/test-runtime"),{method:"POST",body:JSON.stringify({config:C.value})});_.value=(v=m==null?void 0:m.data)==null?void 0:v.context,console.log("getTestedContextFromRuntime",_.value)}catch(m){console.error(m)}I.value=!1},B=(v,m)=>v.preparedPipes[m],G=Yt(P,1e3);Ne(C,()=>{G()},{deep:!0}),Be(async()=>{n.value=!0,await b(),P(),n.value=!1,console.warn("AOWEKOWKEOAWE",C.value)});const z=w([{name:"chatgpt.commander",label:"Chat GPT - Commander Prompt",initialConfig:{name:"chatgpt.commander",option:{input:void 0,prompt:"input your prompt here",output:["Summarized","string"]}}},{name:"filter.simple",label:"Filter - Simple",initialConfig:{name:"filter.simple",option:{input:void 0,blacklistWords:["ngentod"],output:["Filtered","string"]}}}]),p=w(),V=()=>{const v=z.value.find(m=>{var x;return m.name===((x=p.value)==null?void 0:x.pipe)});if(p.value&&p.value.pipe&&v){let m=0;p.value.mode==="after"?m=p.value.currI+1:m=p.value.currI,v&&C.value.pipes.splice(m,0,v.initialConfig),p.value.show=!1}};return(v,m)=>{const x=We,g=Me,S=Re,j=Zt,U=Qt,ee=en,R=oe,te=Ye,q=Ge;return s(),L(q,{open:!0,title:e.mode==="edit"?"Edit Trigger":"Create Trigger",modalSize:"2xl",onClose:m[3]||(m[3]=()=>v.$emit("close"))},{"footer-actions":$(()=>[y("button",{class:"px-4 py-2 bg-blue-400 text-sm rounded",onClick:c},"Save")]),default:$(()=>[(s(),h("div",tn,[y("div",nn,[on,f(x,{modelValue:a(l).name,"onUpdate:modelValue":m[0]||(m[0]=i=>a(l).name=i)},null,8,["modelValue"])]),an,y("div",rn,[y("div",ln,[ue(" Pipes "),a(I)?(s(),h("span",sn,"Testing in runtime...")):A("",!0)]),a(_)&&a(C)&&a(l)?(s(),h("div",un,[(s(!0),h(W,null,Y(a(C).pipes,(i,T)=>(s(),h("div",{key:T},[y("div",cn,[f(g,{"runtime-context":a(_).preparedPipes[T]},null,8,["runtime-context"]),y("div",null,[f(S,{name:"i-heroicons-arrow-down-20-solid",class:"text-gray-500 text-2xl"})])]),y("div",dn,[y("div",mn,Z(i.name),1),y("div",gn,[i.name==="chatgpt.commander"?(s(),L(j,{key:0,i:T,trigger:a(l),config:a(C).pipes[T],runtimeContext:a(_)},null,8,["i","trigger","config","runtimeContext"])):A("",!0),i.name==="filter.simple"?(s(),L(U,{key:1,i:T,trigger:a(l),config:a(C).pipes[T],runtimeContext:a(_)},null,8,["i","trigger","config","runtimeContext"])):A("",!0),i.name==="output"?(s(),L(ee,{key:2,i:T,trigger:a(l),config:a(C).pipes[T],runtimeContext:a(_),bots:a(d),onConfigUpdated:E=>{a(C).pipes[T].option.bots=E}},null,8,["i","trigger","config","runtimeContext","bots","onConfigUpdated"])):A("",!0)]),y("div",fn,[y("div",null,[B(a(_),T).outputs.length>0?(s(),h("div",pn,[y("div",null,[ue(" Output Variable : "),(s(!0),h(W,null,Y(B(a(_),T).outputs,(E,Ie)=>(s(),h("span",{key:Ie},Z(E[0]),1))),128))])])):A("",!0)]),y("div",vn,[f(R,{size:"xs",color:"green",label:"+",icon:"i-heroicons-arrow-up-20-solid",onClick:X(()=>{p.value={show:!0,pipe:"chatgpt.commander",currI:T,mode:"before"}},["prevent"])},null,8,["onClick"]),i.name!=="output"?(s(),h(W,{key:0},[f(R,{size:"xs",color:"green",label:"+",icon:"i-heroicons-arrow-down-20-solid",onClick:X(()=>{p.value={show:!0,pipe:"chatgpt.commander",currI:T,mode:"after"}},["prevent"])},null,8,["onClick"]),f(R,{size:"xs",color:"red",icon:"i-heroicons-trash-20-solid",onClick:X(()=>{a(C).pipes.splice(T,1)},["prevent"])},null,8,["onClick"])],64)):A("",!0)])])]),T!==a(C).pipes.length-1?(s(),h("div",bn,[f(S,{name:"i-heroicons-arrow-down-20-solid",class:"text-gray-500 text-2xl"})])):A("",!0)]))),128))])):A("",!0)])])),(s(),L(Ue,{to:"body"},[f(q,{open:a(p)&&a(p).show,title:"Add Pipe",onClose:m[2]||(m[2]=()=>{a(p)&&(a(p).show=!1)})},{"footer-actions":$(()=>[f(R,{color:"green",label:"Add",onClick:X(V,["prevent"])})]),default:$(()=>[a(p)?(s(),h("div",_n,[y("div",yn,[hn,f(te,{modelValue:a(p).pipe,"onUpdate:modelValue":m[1]||(m[1]=i=>a(p).pipe=i),options:a(z),placeholder:"Select Pipe","value-attribute":"name","option-attribute":"label"},null,8,["modelValue","options"])])])):A("",!0)]),_:1},8,["open"])]))]),_:1},8,["title"])}}}),Tn=Q({__name:"index",setup(e){const o=w(null),r=w(),t=w("edit"),u=async l=>{var n;const d=window.confirm("Are you sure?");try{if(!d)return;const b=await $fetch(N(`/triggers/${l}`),{method:"DELETE"});console.log(b)}catch(b){console.error(b)}(n=o.value)==null||n.refresh()};return(l,d)=>{const n=oe,b=_e,c=ye,C=Cn;return s(),h("div",null,[f(c,{ref_key:"datatable",ref:o,title:"Bot Triggers",columns:[{key:"name",data:"name",label:"Name"},{key:"action",label:""}],rows:[],"api-url":("parseApiURL"in l?l.parseApiURL:a(N))("/triggers")},{action:$(()=>[y("button",{class:"px-4 py-2 bg-gray-800 text-sm rounded",onClick:d[0]||(d[0]=()=>{r.value={config:{pipes:[{name:"output",option:{bots:[]}}]},id:-1,name:"your trigger name"},t.value="create"})}," New ")]),"col-action":$(({data:_})=>[f(b,{items:[[{label:"Edit",icon:"i-heroicons-pencil-square-20-solid",click:()=>{r.value=_,t.value="edit"}}],[{label:"Delete",icon:"i-heroicons-trash-20-solid",click:()=>u(_.id)}]]},{default:$(()=>[f(n,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),_:1},8,["api-url"]),a(r)?(s(),L(C,{key:0,mode:a(t),data:a(r),onClose:d[1]||(d[1]=()=>{var _;r.value=void 0,(_=a(o))==null||_.refresh()})},null,8,["mode","data"])):A("",!0)])}}}),$n={},In=y("button",{class:"px-4 py-2 bg-gray-800 text-sm rounded",onClick:()=>{}}," New ",-1),Sn=["innerHTML"],kn=y("button",{class:"text-sm text-gray-200",onClick:()=>{}}," View ",-1);function xn(e,o){const r=ye;return s(),h("div",null,[f(r,{title:"Triggered History",columns:[{key:"name",data:"name",label:"Name"},{key:"bots",label:"Bots"},{key:"action",label:""}],rows:[],"api-url":("parseApiURL"in e?e.parseApiURL:a(N))("/triggers")},{action:$(()=>[In]),"col-bots":$(({data:t})=>[y("div",{innerHTML:[...(t==null?void 0:t.Bots)||[]].map(u=>`<span>${u==null?void 0:u.name}</span>`).join(", ")},null,8,Sn)]),"col-action":$(({})=>[kn]),_:1},8,["api-url"])])}const An=ae($n,[["render",xn]]),wn={};function On(e,o){const r=ke,t=xe,u=Tn,l=Ae,d=An,n=we,b=Se;return s(),h("div",null,[f(b,null,{default:$(()=>[f(t,{class:"flex rounded overflow-hidden w-auto"},{default:$(()=>[f(r,{as:"template"},{default:$(({selected:c})=>[y("button",{class:F({"px-4 py-2 bg-gray-800":c,"px-4 py-2 bg-transparent":!c,"outline-none":!0})}," Triggers ",2)]),_:1})]),_:1}),f(n,null,{default:$(()=>[f(l,{class:"mt-6"},{default:$(()=>[f(u)]),_:1}),f(l,{class:"mt-6"},{default:$(()=>[f(d)]),_:1})]),_:1})]),_:1})])}const zn=ae(wn,[["render",On]]);export{zn as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./ChatGptCommanderPipe.KRv-A-Xa.js","./Textarea.44oLfERW.js","./entry.6dM_dXCU.js","./entry.K80jiCQ5.css","./api.e8gGccRP.js","./OutputSelectorDataConfig.vue.YcaGLI4P.js","./FilterSimplePipe._Xw85zSG.js","./SelectMenu.ummBI4C7.js","./OutputPipe.Kc1hPyeE.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
